---
import Head from '../components/Head.astro';
import { ViewTransitions } from 'astro:transitions';
import '../styles/global.css';

const title = "Ristoranti dKarbon y Limon a Milano";
const description = "Ristorante peruviano a Milano. Scegli la tua sede: Viale Tibaldi o Piazza Tirana. Cucina autentica, cocktail bar, eventi.";
---

<html lang="it">
  <head>
    <Head title={title} description={description} />
    <ViewTransitions />
  </head>
  <body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <img src="/assets/dkarbonylimon-foto-og.jpg" alt="Loading..." />
    </div>

    <div class="intro-container">
      <div class="logo-overlay">
        <img src="/assets/logo.png" alt="DK&L Logo" width="80" height="80" onerror="this.style.display='none'" />
        <div class="welcome-text">WELCOME TO</div>
      </div>
      
      <a href="/sede-tibaldi-10/" class="split left">
        <div class="bg-image lazy-bg" data-bg="/assets/intro-left.webp"></div>
        <div class="content">
          <h2>VIALE TIBALDI 10, MILANO</h2>
          <span class="btn btn-outline" style="border-color: #fff; color: #fff;">SCEGLI SEDE</span>
        </div>
      </a>
      
      <a href="/sede-piazza-tirana-22/" class="split right">
        <div class="bg-image lazy-bg" data-bg="/assets/intro-right.webp"></div>
        <div class="content">
          <h2>PIAZZA TIRANA 22, MI</h2>
          <span class="btn btn-outline" style="border-color: #fff; color: #fff;">SCEGLI SEDE</span>
        </div>
      </a>
    </div>

    <script>
      // Simple lazy load for background images
      document.addEventListener("DOMContentLoaded", function() {
        var lazyBackgrounds = [].slice.call(document.querySelectorAll(".lazy-bg"));
        
        if ("IntersectionObserver" in window) {
          let lazyBackgroundObserver = new IntersectionObserver(function(entries, observer) {
            entries.forEach(function(entry) {
              if (entry.isIntersecting) {
                let bgDiv = entry.target as HTMLElement;
                bgDiv.style.backgroundImage = "url('" + bgDiv.dataset.bg + "')";
                bgDiv.classList.remove("lazy-bg");
                lazyBackgroundObserver.unobserve(entry.target);
              }
            });
          });
        
          lazyBackgrounds.forEach(function(lazyBackground) {
            lazyBackgroundObserver.observe(lazyBackground);
          });
        }
      });
      
      // Loading Screen Logic
      window.addEventListener('load', () => {
          const loader = document.getElementById('loading-screen');
          if (loader) {
              setTimeout(() => {
                  loader.style.opacity = '0';
                  setTimeout(() => {
                      loader.style.display = 'none';
                  }, 800); // Wait for transition
              }, 1000); // Minimum visibility time
          }
      });
    </script>

    <style>
      .intro-container {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        display: flex;
      }
      
      /* Loading Screen Styles */
      #loading-screen {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: #000;
          z-index: 9999;
          display: flex;
          justify-content: center;
          align-items: center;
          transition: opacity 0.8s ease-out;
      }
      
      #loading-screen img {
          max-width: 200px;
          border-radius: 50%; /* Circular */
          aspect-ratio: 1 / 1;
          object-fit: cover;
          border: 4px solid var(--color-primary); /* Optional: adds a nice finish */
          animation: pulse 2s infinite;
      }
      
      @keyframes pulse {
          0% { transform: scale(0.95); opacity: 0.8; }
          50% { transform: scale(1.05); opacity: 1; }
          100% { transform: scale(0.95); opacity: 0.8; }
      }

      /* ... (keep logo styles) ... */
      .logo-overlay {
        position: absolute;
        top: 2rem;
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
        text-align: center;
        width: 200px;
      }

      .logo-overlay img {
        display: block;
        margin: 0 auto 10px;
      }

      .welcome-text {
        font-family: var(--font-heading);
        color: #fff;
        font-size: 1.2rem;
        font-size: 1.2rem;
        letter-spacing: 0;
        text-shadow: 0 2px 4px rgba(0,0,0,0.8);
      }

      .split {
        flex: 1;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        text-decoration: none;
        transition: flex 0.5s ease;
        overflow: hidden;
      }

      .split:hover {
        flex: 1.2; /* Was 1.5 - softer expansion */
      }

      .bg-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #222; /* Placeholder color */
        background-size: cover;
        background-position: center;
        transition: transform 0.5s ease;
        z-index: 0;
      }
      
      .split:hover .bg-image {
          transform: scale(1.02); /* Was 1.05 - softer zoom */
      }

      .split::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.6);
        z-index: 1;
        transition: background 0.3s;
      }

      .split:hover::before {
        background: rgba(0,0,0,0.4);
      }

      .content {
        position: relative;
        z-index: 2;
        text-align: center;
        padding: 2rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      .content h2 {
        color: #fff;
        font-size: 35px;
        margin-bottom: 2rem;
        text-shadow: 0 2px 10px rgba(0,0,0,0.8);
        position: relative;
        display: inline-block;
      }
      
      .content h2::after {
        content: '';
        position: absolute;
        width: 0;
        height: 2px;
        bottom: -5px;
        left: 0;
        background-color: var(--color-primary);
        transition: width 0.3s ease;
      }

      .split:hover .content h2::after {
        width: 100%;
      }

      @media (max-width: 768px) {
        .intro-container {
          flex-direction: column;
        }
        
        .split:hover {
            flex: 1;
        }
        
        .content h2 {
            font-size: 1.8rem;
        }
      }
    </style>
  </body>
</html>
