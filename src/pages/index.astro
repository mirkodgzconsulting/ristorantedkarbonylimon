---
import Head from '../components/Head.astro';
import { ViewTransitions } from 'astro:transitions';
import '../styles/global.css';

import { sedes } from '../data/siteData';

const title = "Ristoranti dKarbon y Limon a Milano";
const description = "Ristorante peruviano a Milano. Scegli la tua sede: Viale Tibaldi o Piazza Tirana. Cucina autentica, cocktail bar, eventi.";

const schema = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Ristorante D'Karbon y Limon",
  "url": "https://ristorantedkarbonylimon.it",
  "logo": "https://ristorantedkarbonylimon.it/assets/dkarbonylimon-foto-og.jpg",
  "description": description,
  "sameAs": [
    ...new Set(sedes.flatMap(sede => Object.values(sede.social)))
  ]
};
---

<html lang="it">
  <head>
    <Head title={title} description={description} schema={schema} />
    <ViewTransitions />
  </head>
  <body>
    <!-- Loading Screen -->
    <div class="intro-container">
      <div class="logo-overlay">
        <div class="welcome-text">WELCOME TO</div>
        <img src="/assets/dkarbonylimon-foto-og.jpg" alt="DK&L Logo" class="central-logo" />
      </div>
      
      <a href="/sede-tibaldi-10/" class="split left">
        <div class="bg-image lazy-bg" data-bg="/assets/intro-left.webp"></div>
        <div class="content">
          <h2>VIALE TIBALDI 10, MILANO</h2>
          <span class="btn intro-btn">
            <span class="material-symbols-outlined" style="font-size: 1.2em;">location_on</span>
            SCEGLI SEDE
          </span>
        </div>
      </a>
      
      <a href="/sede-tirana-22/" class="split right">
        <div class="bg-image lazy-bg" data-bg="/assets/intro-right.webp"></div>
        <div class="content">
          <h2>PIAZZA TIRANA 22, MILANO</h2>
          <span class="btn intro-btn">
            <span class="material-symbols-outlined" style="font-size: 1.2em;">location_on</span>
            SCEGLI SEDE
          </span>
        </div>
      </a>
    </div>

    <script>
      // Simple lazy load for background images
      // Simple lazy load for background images - Updated for View Transitions
      document.addEventListener("astro:page-load", function() {
        var lazyBackgrounds = [].slice.call(document.querySelectorAll(".lazy-bg"));
        
        if ("IntersectionObserver" in window) {
          let lazyBackgroundObserver = new IntersectionObserver(function(entries, observer) {
            entries.forEach(function(entry) {
              if (entry.isIntersecting) {
                let bgDiv = entry.target as HTMLElement;
                bgDiv.style.backgroundImage = "url('" + bgDiv.dataset.bg + "')";
                bgDiv.classList.remove("lazy-bg");
                lazyBackgroundObserver.unobserve(entry.target);
              }
            });
          });
        
          lazyBackgrounds.forEach(function(lazyBackground) {
            lazyBackgroundObserver.observe(lazyBackground);
          });
        }
      });
    </script>

    <style>
      .intro-container {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        display: flex;
      }
      
      /* Overlay Styles */
      .logo-overlay {
        position: absolute;
        top: 50%; /* Centered vertically */
        left: 50%; /* Centered horizontally */
        transform: translate(-50%, -50%); /* Adjust for own size */
        z-index: 10;
        text-align: center;
        width: 300px; /* Increased to fit larger logo */
        pointer-events: none; /* Let clicks pass through */
      }

      .welcome-text {
        font-family: var(--font-heading);
        color: var(--color-primary); /* Yellow */
        font-size: calc(1.2rem + 5px); /* Increased size */
        margin-bottom: 1rem;
        letter-spacing: 0;
        text-shadow: 0 2px 4px rgba(0,0,0,0.8);
        text-transform: uppercase;
        font-weight: bold;
      }

      .central-logo {
        width: 200px;
        height: 200px;
        border-radius: 50%;
        object-fit: cover;
        border: 4px solid #fff; /* White border for contrast */
        box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        display: block;
        margin: 0 auto;
      }

      .split {
        flex: 1;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        text-decoration: none;
        transition: flex 0.5s ease;
        overflow: hidden;
      }
      
      .split.left {
          border-right: 1px solid #fff; /* 1px right */
      }
      
      .split.right {
          border-left: 1px solid #fff; /* 1px left */
      }

      .split:hover {
        flex: 1.05;
      }

      .bg-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #222; 
        background-size: cover;
        background-position: center;
        transition: transform 0.5s ease;
        z-index: 0;
      }
      
      .split:hover .bg-image {
          transform: scale(1.01);
      }

      .split::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.3);
        z-index: 1;
        transition: background 0.3s;
      }

      .split:hover::before {
        background: rgba(0,0,0,0.4);
      }

      .content {
        position: relative;
        z-index: 2;
        text-align: center;
        padding: 2rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin-top: 150px; /* Push content down to avoid overlap with central logo */
      }

      .content h2 {
        color: #fff;
        font-size: 35px;
        margin-bottom: 2rem;
        text-shadow: 0 2px 10px rgba(0,0,0,0.8);
        position: relative;
        display: inline-block;
      }
      
      .content h2::after {
        content: '';
        position: absolute;
        width: 0;
        height: 2px;
        bottom: -5px;
        left: 0;
        background-color: var(--color-primary);
        transition: width 0.3s ease;
      }

      .split:hover .content h2::after {
        width: 100%;
      }

      @media (max-width: 768px) {
        .intro-container {
          flex-direction: column;
        }
        
        .logo-overlay {
            /* Keep centered on mobile */
            top: 50%; 
            transform: translate(-50%, -50%);
        }
        
        .central-logo {
            width: 150px;
            height: 150px;
        }
        
        .content {
            margin-top: 0; /* No margin needed in vertical stack */
            padding: 1.5rem; /* Reduced padding for mobile */
        }

        .split:hover {
            flex: 1;
        }
        
        .split.left {
            border-right: none;
            border-bottom: 1px solid #fff;
        }
        
        .split.right {
            border-left: none;
            border-top: 1px solid #fff;
        }

        .content h2 {
            font-size: 30px !important;
        }
      }
      
      /* Button Styling */
      .intro-btn {
          border: 1px solid #000 !important;
          background-color: var(--color-primary); 
          color: #000; 
          letter-spacing: 0px !important; 
          transition: all 0.3s ease;
          display: inline-flex !important;
          align-items: center;
          gap: 5px;
      }
      
      .intro-btn:hover {
          color: #000 !important;
          background-color: #fff;
          border-color: #fff !important;
          transform: scale(1.05);
      }

    </style>
  </body>
</html>
